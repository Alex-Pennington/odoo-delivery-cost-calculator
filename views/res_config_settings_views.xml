<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Add Delivery Cost Calculator settings to Sales settings page -->
    <record id="res_config_settings_view_form" model="ir.ui.view">
        <field name="name">res.config.settings.view.form.inherit.delivery.cost</field>
        <field name="model">res.config.settings</field>
        <field name="priority" eval="90"/>
        <field name="inherit_id" ref="sale.res_config_settings_view_form"/>
        <field name="arch" type="xml">
            <!-- Add GPS Delivery settings after the delivery module settings -->
            <xpath expr="//div[@class='row mt16 o_settings_container' and .//div[@name='module_delivery']]" position="inside">
                
                <!-- GPS Delivery Cost Calculator Settings -->
                <div class="col-12 col-lg-6 o_setting_box o_searchable_setting">
                    <div class="o_setting_left_pane">
                        <span class="o_form_label">GPS Delivery Calculator</span>
                    </div>
                    <div class="o_setting_right_pane">
                        <label for="delivery_origin_latitude">
                            <b>Origin Coordinates</b>
                        </label>
                        <div class="text-muted">
                            Starting point for delivery distance calculations
                        </div>
                        <div class="content-group mt16">
                            <div class="row mt8">
                                <label for="delivery_origin_latitude" class="col-3 col-lg-4 o_light_label">Latitude</label>
                                <field name="delivery_origin_latitude" class="col-9 col-lg-8"/>
                            </div>
                            <div class="row mt8">
                                <label for="delivery_origin_longitude" class="col-3 col-lg-4 o_light_label">Longitude</label>
                                <field name="delivery_origin_longitude" class="col-9 col-lg-8"/>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pricing Configuration -->
                <div class="col-12 col-lg-6 o_setting_box o_searchable_setting">
                    <div class="o_setting_left_pane">
                        <span class="o_form_label">Pricing</span>
                    </div>
                    <div class="o_setting_right_pane">
                        <label for="delivery_rate_per_mile">
                            <b>Rate per Mile</b>
                        </label>
                        <div class="text-muted">
                            Cost per mile for delivery calculation
                        </div>
                        <div class="content-group mt16">
                            <div class="row mt8">
                                <label for="delivery_rate_per_mile" class="col-3 col-lg-4 o_light_label">$/mile</label>
                                <field name="delivery_rate_per_mile" class="col-9 col-lg-8"/>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Distance Limits -->
                <div class="col-12 col-lg-6 o_setting_box o_searchable_setting">
                    <div class="o_setting_left_pane">
                        <span class="o_form_label">Distance Limits</span>
                    </div>
                    <div class="o_setting_right_pane">
                        <label for="delivery_max_distance">
                            <b>Maximum Distances</b>
                        </label>
                        <div class="text-muted">
                            Distance limits for delivery service
                        </div>
                        <div class="content-group mt16">
                            <div class="row mt8">
                                <label for="delivery_max_distance" class="col-3 col-lg-4 o_light_label">Manual Orders</label>
                                <field name="delivery_max_distance" class="col-9 col-lg-8"/>
                            </div>
                            <div class="row mt8">
                                <label for="delivery_gps_carrier_max_distance" class="col-3 col-lg-4 o_light_label">Website Orders</label>
                                <field name="delivery_gps_carrier_max_distance" class="col-9 col-lg-8"/>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Limits -->
                <div class="col-12 col-lg-6 o_setting_box o_searchable_setting">
                    <div class="o_setting_left_pane">
                        <span class="o_form_label">Order Limits</span>
                    </div>
                    <div class="o_setting_right_pane">
                        <label for="delivery_max_order_quantity">
                            <b>Maximum Order Quantity</b>
                        </label>
                        <div class="text-muted">
                            Maximum items for GPS carrier on website
                        </div>
                        <div class="content-group mt16">
                            <div class="row mt8">
                                <label for="delivery_max_order_quantity" class="col-3 col-lg-4 o_light_label">Max Units</label>
                                <field name="delivery_max_order_quantity" class="col-9 col-lg-8"/>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Road Distance Configuration -->
                <div class="col-12 col-lg-6 o_setting_box o_searchable_setting">
                    <div class="o_setting_left_pane">
                        <span class="o_form_label">Road Distance</span>
                    </div>
                    <div class="o_setting_right_pane">
                        <label for="delivery_road_multiplier">
                            <b>Road Distance Multiplier</b>
                        </label>
                        <div class="text-muted">
                            Multiply straight-line distance to estimate road distance
                        </div>
                        <div class="content-group mt16">
                            <div class="row mt8">
                                <label for="delivery_road_multiplier" class="col-3 col-lg-4 o_light_label">Multiplier</label>
                                <field name="delivery_road_multiplier" class="col-9 col-lg-8"/>
                            </div>
                            <div class="row mt8">
                                <span class="col-12 text-muted fst-italic">
                                    Typical values: 1.2 (straight roads), 1.3 (average), 1.4 (winding roads)
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Google Maps API Configuration -->
                <div class="col-12 col-lg-6 o_setting_box o_searchable_setting">
                    <div class="o_setting_left_pane">
                        <field name="delivery_use_google_maps" class="o_field_boolean"/>
                    </div>
                    <div class="o_setting_right_pane">
                        <label for="delivery_use_google_maps">
                            <b>Use Google Maps API</b>
                        </label>
                        <div class="text-muted">
                            Enable for accurate road-based distances (~$0.005 per calculation)
                        </div>
                        <div class="content-group mt16" invisible="not delivery_use_google_maps">
                            <div class="row mt8">
                                <label for="delivery_google_api_key" class="col-3 col-lg-4 o_light_label">API Key</label>
                                <field name="delivery_google_api_key" class="col-9 col-lg-8" password="True"/>
                            </div>
                            <div class="row mt8">
                                <div class="col-12">
                                    <button name="%(base.action_open_website)d" 
                                            type="action" 
                                            string="Get API Key" 
                                            icon="fa-external-link" 
                                            class="btn-link"
                                            context="{'url': 'https://console.cloud.google.com/'}"/>
                                    <span class="text-muted ms-2">â†’ Google Cloud Console</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </xpath>
        </field>
    </record>
</odoo>
